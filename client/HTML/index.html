<!DOCTYPE html>
<html>
    <head>

        <meta charset="utf-8" />
        <title>Versioning</title>
      
        <script>

          function getCookie(cname) {
            var name = cname + "=";
            var decodedCookie = decodeURIComponent(document.cookie);
            var ca = decodedCookie.split(';');
            for(var i = 0; i <ca.length; i++) {
              var c = ca[i];
              while (c.charAt(0) == ' ') {
                c = c.substring(1);
              }
              if (c.indexOf(name) == 0) {
                return c.substring(name.length, c.length);
              }
            }
            return "";
          }

          function logout(){
            document.cookie = "ID= ; expires = Thu, 01 Jan 1970 00:00:00 GMT"
            document.cookie = "wall= ; expires = Thu, 01 Jan 1970 00:00:00 GMT"
            document.cookie = "name= ; expires = Thu, 01 Jan 1970 00:00:00 GMT"
          }
          
          function loadDoc() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
              if (this.readyState == 4 && this.status == 200) {
                //document.getElementById("list").innerHTML =
                //this.responseText;
                var docs = JSON.parse(this.responseText);
                console.log(docs);
                var table = '<table>';
                for(var i=0; i < docs.doc.length; i++){
                  console.log(docs.doc[i]);
                  table += '<tr>';
                  table += '<td>'+docs.doc[i].id+'</td>'+'<td>'+docs.doc[i].path+'</td>'+'<td>'+docs.doc[i].description+'</td>';
                  table += '</tr>';
                }
                table += '</table>';
                document.getElementById("list").innerHTML = table;//usr.user[0].first;
              }
            };
            xhttp.open("GET", "/list", true);
            xhttp.send();
            
            if(getCookie("ID") != ""){
              document.getElementById("login").style.display = "none";
              document.getElementById("subs").style.display = "none";
              document.getElementById("logout").style.display = "block";
            }
            else{
              document.getElementById("logout").style.display = "none";
            }

          }
      </script>

    </head>

    <body onload="loadDoc()">
        <h1>Blockchain Versioning</h1>
        <p id="logout"><a href="/" onclick="logout()">Logout</a></p>
        <p id="subs"><a href="subscribe.html">Subscribe</a></p>
        <p id="login"><a href="login.html">Login</a></p>
        <p><a href="add.html">New Document</a></p>
        <p><a href="example.html">Example</a></p>


        <div id = "list">
            <!--<button type="button" onclick="loadDoc()">Change Content</button>-->
        </div>
    </body>


</html>